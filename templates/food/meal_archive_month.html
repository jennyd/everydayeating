{% extends "food/base.html" %}
{% load humanize %}

{% block content %}

    <h1>Meals in {{ month|date:'F Y' }}</h1>

    <h2>Weekly index</h2>

    {% for week in week_list %}
        <a href="{% url meal_archive_week week.date.year week.date|date:'W' %}">Week beginning {{ week.date|date:'jS F Y' }}</a> {{ week.calories|floatformat:0|intcomma }} calories per day<br />
    {% endfor %}

    <h2>Daily index</h2>

    {% for date in date_list %}
        <h3>
        <a href="{% url meal_archive_day date.year date|date:'m' date|date:'d' %}">{{ date|date:'l jS F' }}</a>
        </h3>

        <table>
        {% for meal in meal_list %}
            {% if date.date == meal.date %}
                <tr>
                <td><a href="{% url meal_detail meal.id %}">{{ meal.name }}</a></td>
                <td>{{ meal.date|naturalday }}</td>
                <td>at</td>
                <td>{{ meal.time }}</td>
                <td>({{ meal.calories|floatformat:0|intcomma }} calories)</td>
                <td><a class="deletelink" href="{% url meal_delete meal.id %}">Delete</a></td>
                </tr>
            {% endif %}
        {% endfor %}
        </table>
    {% endfor %}

    <p>
    <a href="{% url meal_add %}">Add a new meal</a>
    </p>

    <p>
    {% if previous_month %}
        <a href="{% url meal_archive_month previous_month.year previous_month|date:'m' %}"><-- {{ previous_month|date:'F Y' }}</a>
    {% endif %}
    {% if next_month %}
        <a href="{% url meal_archive_month next_month.year next_month|date:'m' %}">{{ next_month|date:'F Y' }} --></a><br />
    {% endif %}
    </p>

{% endblock content %}
